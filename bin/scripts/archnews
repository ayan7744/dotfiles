#!/bin/bash

show_news() {
    curl -sSL https://archlinux.org/feeds/news/ | \
    awk '
    function extract(text, tag) {
      sub(".*<" tag ">", "", text);
      sub("</" tag ">.*", "", text);
      return text
    }
    BEGIN {
      RS = "</item>";
      
      # Define ANSI escape codes for colors and styles
      C_RESET = "\033[0m";
      C_BOLD  = "\033[1m";
      C_TITLE = "\033[36m"; # Cyan
      C_DATE  = "\033[32m"; # Green
      C_LINK  = "\033[34m"; # Blue
      C_SEP   = "\033[2;37m";# Dim White
    }
    NR > 3 { exit }
    {
      # Extract the data first
      title   = extract($0, "title");
      pubDate = extract($0, "pubDate");
      link    = extract($0, "link");

      # Print formatted and colorized output
      printf "%s%s%-8s%s%s%s\n", C_BOLD, C_TITLE, "Title:", C_RESET, C_BOLD, title;
      printf "%s%-8s%s%s\n", C_DATE, "Date:", C_RESET, pubDate;
      printf "%s%-8s%s%s\n", C_LINK, "Link:", C_RESET, link;

      # Print a separator between items, but not after the last one
      if (NR < 3) {
        print C_SEP "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━" C_RESET;
      }
    }
    '
}


case $1 in
    *)
        isonline && show_news
        ;;
esac
